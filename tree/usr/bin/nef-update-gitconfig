#!/bin/bash

configFile=/etc/gitconfig
configDir=${configFile}.d

. /usr/lib/sysconf.base/common.sh

comment="# GENERATED BY SYSCONF"

[ -d $configDir ] || nef_fatal "Config dir does not exist: $configDir"

[ -r $configFile ] && {
    cat $configFile | grep -q "$comment" || nef_fatal "config file exists and was not generated: $configFile"
}

nef_log "Generating: $configFile"
echo "$comment" >$configFile
echo "[include]" >>$configFile

for file in `find -L $configDir -type f -name '*.conf'`; do
    nef_log "Include config: $file"
    echo "  path = $file" >>$configFile
done

nef_log "Done."
